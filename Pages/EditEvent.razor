@page "/edit-event/{EventId:int}"
@using System.Threading.Tasks
@inject EventService EventService
@inject NavigationManager Navigation

<h3>Edit Event</h3>

@if (eventToEdit == null)
{
    <p class="text-danger">Event not found.</p>
}
else
{
    <EditForm Model="@eventToEdit" OnValidSubmit="SaveChanges">
        <DataAnnotationsValidator />
        <ValidationSummary />

        <div>
            <label>Name:</label>
            <InputText @bind-Value="eventToEdit.Name" class="form-control" />
        </div>

        <div>
            <label>Description:</label>
            <InputText @bind-Value="eventToEdit.Description" class="form-control" />
        </div>

        <div>
            <label>Location:</label>
            <InputText @bind-Value="eventToEdit.Location" class="form-control" />
        </div>

        <div>
            <label>Date:</label>
            <InputDate @bind-Value="eventToEdit.Date" class="form-control" />
        </div>

        <button class="btn btn-success mt-3" type="submit">Save</button>
    </EditForm>
}

@code {
    [Parameter] public int EventId { get; set; }
    private Event? eventToEdit;

    protected override void OnInitialized()
    {
        eventToEdit = EventService.GetEvents().FirstOrDefault(e => e.Id == EventId);
    }

    private async Task SaveChanges()
    {
        await EventService.UpdateEvent(eventToEdit!);
        Navigation.NavigateTo("/eventmgr");
    }
}
